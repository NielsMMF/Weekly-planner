<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#333333">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Weekly Planner">
    <link rel="manifest" href="data:application/json,{%22name%22:%22Weekly%20Planner%22,%22short_name%22:%22Planner%22,%22display%22:%22standalone%22,%22background_color%22:%22%23fafafa%22,%22theme_color%22:%22%23333333%22,%22icons%22:[{%22src%22:%22data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23333'/%3E%3Ctext x='50' y='60' font-size='40' text-anchor='middle' fill='white'%3EðŸ“…%3C/text%3E%3C/svg%3E%22,%22sizes%22:%22192x192%22,%22type%22:%22image/svg+xml%22}]}">
    <title>Weekly Planner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: #fafafa;
        padding: 10px;
        min-height: 100vh;
    }

    .header {
        text-align: center;
        margin-bottom: 20px;
        padding: 10px 0;
    }

    .week-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .nav-btn {
        background: #333;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
    }

    .nav-btn:hover {
        background: #555;
    }

    .week-title {
        font-size: 18px;
        font-weight: 600;
        color: #333;
    }

    .planner-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1px;
        background-color: #ddd;
        border: 1px solid #ddd;
        border-radius: 4px;
        overflow: hidden;
    }

    .day-row {
        background: white;
        display: grid;
        grid-template-columns: 80px 1fr;
        min-height: 120px;
    }

    .day-label {
        background: #f8f9fa;
        padding: 10px 8px;
        font-weight: 600;
        font-size: 12px;
        color: #555;
        border-right: 1px solid #eee;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        text-align: center;
    }

    .day-name {
        margin-bottom: 4px;
    }

    .day-date {
        font-size: 11px;
        color: #888;
        font-weight: normal;
    }

    .day-content {
        padding: 8px;
        display: flex;
        flex-direction: column;
    }

    .task-list {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .task-item {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        min-height: 24px;
    }

    .task-checkbox {
        width: 16px;
        height: 16px;
        margin-top: 2px;
        cursor: pointer;
        flex-shrink: 0;
    }

    .task-text {
        flex-grow: 1;
        border: none;
        outline: none;
        background: transparent;
        font-family: inherit;
        font-size: 14px;
        line-height: 1.4;
        resize: none;
        min-height: 20px;
        padding: 0;
    }

    .task-text:focus {
        background: #f8f9fa;
        padding: 2px 4px;
        border-radius: 2px;
    }

    .task-text.completed {
        text-decoration: line-through;
        color: #888;
    }

    .add-task-btn {
        background: none;
        border: 1px dashed #ccc;
        color: #888;
        padding: 8px;
        cursor: pointer;
        border-radius: 4px;
        font-size: 13px;
        margin-top: 8px;
    }

    .add-task-btn:hover {
        border-color: #999;
        color: #666;
    }

    .clear-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #ff4444;
        color: white;
        border: none;
        padding: 12px;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        font-size: 16px;
        width: 50px;
        height: 50px;
    }

    .clear-btn:hover {
        background: #cc3333;
    }

    @media (max-width: 480px) {
        .day-row {
            grid-template-columns: 60px 1fr;
            min-height: 100px;
        }
        
        .day-label {
            padding: 8px 4px;
            font-size: 11px;
        }
        
        .task-text {
            font-size: 13px;
        }

        .task-checkbox {
            width: 14px;
            height: 14px;
        }
    }
</style>
```

</head>
<body>
    <div class="header">
        <div class="week-nav">
            <button class="nav-btn" onclick="previousWeek()">â—€ Prev</button>
            <div class="week-title" id="weekTitle"></div>
            <button class="nav-btn" onclick="nextWeek()">Next â–¶</button>
        </div>
    </div>

```
<div class="planner-grid" id="plannerGrid">
    <!-- Days will be generated by JavaScript -->
</div>

<button class="clear-btn" onclick="clearAll()" title="Clear all tasks">âœ•</button>

<script>
    let currentWeekStart = new Date();
    const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

    // Set to start of current week (Sunday)
    function setToWeekStart(date) {
        const day = date.getDay();
        const diff = date.getDate() - day;
        return new Date(date.setDate(diff));
    }

    currentWeekStart = setToWeekStart(new Date());

    function updateWeekTitle() {
        const endDate = new Date(currentWeekStart);
        endDate.setDate(endDate.getDate() + 6);
        
        const startMonth = months[currentWeekStart.getMonth()];
        const endMonth = months[endDate.getMonth()];
        const startDay = currentWeekStart.getDate();
        const endDay = endDate.getDate();
        const year = currentWeekStart.getFullYear();
        
        let title = `${startMonth} ${startDay}`;
        if (startMonth !== endMonth) {
            title += ` - ${endMonth} ${endDay}`;
        } else {
            title += ` - ${endDay}`;
        }
        title += `, ${year}`;
        
        document.getElementById('weekTitle').textContent = title;
    }

    function generatePlanner() {
        const grid = document.getElementById('plannerGrid');
        grid.innerHTML = '';
        
        for (let i = 0; i < 7; i++) {
            const date = new Date(currentWeekStart);
            date.setDate(date.getDate() + i);
            
            const dayRow = document.createElement('div');
            dayRow.className = 'day-row';
            
            const dayLabel = document.createElement('div');
            dayLabel.className = 'day-label';
            dayLabel.innerHTML = `
                <div class="day-name">${daysOfWeek[i].substring(0, 3).toUpperCase()}</div>
                <div class="day-date">${date.getDate()}</div>
            `;
            
            const dayContent = document.createElement('div');
            dayContent.className = 'day-content';
            
            const taskList = document.createElement('div');
            taskList.className = 'task-list';
            taskList.id = `tasks-${i}`;
            
            // Load saved tasks
            const savedTasks = getSavedTasks(date);
            if (savedTasks.length > 0) {
                savedTasks.forEach(task => {
                    addTaskElement(taskList, task.text, task.completed, date);
                });
            } else {
                // Add one empty task by default
                addTaskElement(taskList, '', false, date);
            }
            
            const addBtn = document.createElement('button');
            addBtn.className = 'add-task-btn';
            addBtn.textContent = '+ Add task';
            addBtn.onclick = () => addTaskElement(taskList, '', false, date);
            
            dayContent.appendChild(taskList);
            dayContent.appendChild(addBtn);
            dayRow.appendChild(dayLabel);
            dayRow.appendChild(dayContent);
            grid.appendChild(dayRow);
        }
    }

    function addTaskElement(container, text = '', completed = false, date) {
        const taskItem = document.createElement('div');
        taskItem.className = 'task-item';
        
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'task-checkbox';
        checkbox.checked = completed;
        
        const textInput = document.createElement('textarea');
        textInput.className = 'task-text';
        textInput.value = text;
        textInput.rows = 1;
        if (completed) {
            textInput.classList.add('completed');
        }
        
        // Auto-resize textarea
        textInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
            saveTasks(date);
        });

        // Handle enter key to add new task
        textInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                addTaskElement(container, '', false, date);
                // Focus the new task
                setTimeout(() => {
                    const newTask = container.lastElementChild.querySelector('.task-text');
                    newTask.focus();
                }, 0);
            }
            
            // Delete empty task on backspace
            if (e.key === 'Backspace' && this.value === '' && container.children.length > 1) {
                const prevTask = taskItem.previousElementSibling;
                if (prevTask) {
                    const prevInput = prevTask.querySelector('.task-text');
                    prevInput.focus();
                    prevInput.setSelectionRange(prevInput.value.length, prevInput.value.length);
                }
                taskItem.remove();
                saveTasks(date);
            }
        });
        
        // Handle checkbox change
        checkbox.addEventListener('change', function() {
            if (this.checked) {
                textInput.classList.add('completed');
            } else {
                textInput.classList.remove('completed');
            }
            saveTasks(date);
        });
        
        taskItem.appendChild(checkbox);
        taskItem.appendChild(textInput);
        container.appendChild(taskItem);
        
        // Auto-resize on creation
        textInput.style.height = textInput.scrollHeight + 'px';
        
        return taskItem;
    }

    function getStorageKey(date) {
        return `planner-tasks-${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
    }

    function saveTasks(date) {
        const dayIndex = getDayIndex(date);
        const taskList = document.getElementById(`tasks-${dayIndex}`);
        if (!taskList) return;
        
        const tasks = [];
        taskList.querySelectorAll('.task-item').forEach(item => {
            const checkbox = item.querySelector('.task-checkbox');
            const textInput = item.querySelector('.task-text');
            if (textInput.value.trim() || checkbox.checked) {
                tasks.push({
                    text: textInput.value,
                    completed: checkbox.checked
                });
            }
        });
        
        const key = getStorageKey(date);
        if (tasks.length > 0) {
            localStorage.setItem(key, JSON.stringify(tasks));
        } else {
            localStorage.removeItem(key);
        }
    }

    function getSavedTasks(date) {
        const key = getStorageKey(date);
        const saved = localStorage.getItem(key);
        return saved ? JSON.parse(saved) : [];
    }

    function getDayIndex(date) {
        const daysDiff = Math.floor((date - currentWeekStart) / (1000 * 60 * 60 * 24));
        return daysDiff;
    }

    function previousWeek() {
        currentWeekStart.setDate(currentWeekStart.getDate() - 7);
        updateWeekTitle();
        generatePlanner();
    }

    function nextWeek() {
        currentWeekStart.setDate(currentWeekStart.getDate() + 7);
        updateWeekTitle();
        generatePlanner();
    }

    function clearAll() {
        if (confirm('Clear all tasks for this week?')) {
            for (let i = 0; i < 7; i++) {
                const date = new Date(currentWeekStart);
                date.setDate(date.getDate() + i);
                const key = getStorageKey(date);
                localStorage.removeItem(key);
            }
            generatePlanner();
        }
    }

    // Initialize the planner
    updateWeekTitle();
    generatePlanner();
</script>
```

</body>
</html>
